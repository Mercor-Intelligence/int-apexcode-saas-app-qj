generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model User {
  id           String   @id @default(uuid())
  email        String   @unique
  passwordHash String
  handle       String   @unique
  planTier     String   @default("FREE")
  avatarUrl    String?
  bioTitle     String?
  bioDescription String?
  category     String?
  theme        String   @default("default")
  backgroundColor String @default("#ffffff")
  buttonStyle  String   @default("rounded")
  fontFamily   String   @default("Inter")
  metaTitle    String?
  metaDescription String?
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  
  links        Link[]
  socialIcons  SocialIcon[]
  analytics    AnalyticsEvent[]
}

model Link {
  id           String   @id @default(uuid())
  userId       String
  url          String?
  title        String
  thumbnailUrl String?
  position     Int      @default(0)
  isActive     Boolean  @default(true)
  type         String   @default("CLASSIC")
  settings     String   @default("{}")
  clickCount   Int      @default(0)
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  analytics    AnalyticsEvent[]
}

model SocialIcon {
  id        String   @id @default(uuid())
  userId    String
  platform  String
  url       String
  position  Int      @default(0)
  createdAt DateTime @default(now())
  
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model AnalyticsEvent {
  id          String   @id @default(uuid())
  linkId      String?
  userId      String
  eventType   String
  referrer    String?
  countryCode String?
  device      String?
  timestamp   DateTime @default(now())
  
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  link        Link?    @relation(fields: [linkId], references: [id], onDelete: Cascade)
}

